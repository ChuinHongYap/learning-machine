
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Batch size &#8212; Learning Machine</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8e5499552300ddf5d7adccae7cc3b70.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://rentruewang.github.io/issues/batch/batch.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Gradient Vanishing / Gradient Explosion" href="../gradient/norm.html" />
    <link rel="prev" title="Frequently Encoutered Issues" href="../issues.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Learning Machine</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/basics.html">
   Holy Trinity for Machine Learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/data/data.html">
     Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/model/model.html">
     Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/loss/loss.html">
     Loss Function
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../basics/approx/approx.html">
   Approximation models
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/gradients/gradients.html">
   Gradients
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/gradients/loss-fn-derivative.html">
     Do loss functions have to be differentiable?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/gradients/back-prop.html">
     How Gradients Are Calculated?
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Common Tasks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../tasks/tasks.html">
   Types of tasks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tasks/regression/regression.html">
   Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tasks/classification/classification.html">
   Classification
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Common Building Blocks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../layers/layers.html">
   Layers
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../layers/linear/linear.html">
   Linear Layer
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/linear/linear-grad.html">
     Calculate gradients for Linear Layers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../layers/cnn/cnn.html">
   Convolution Layer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../layers/rnn/rnn.html">
   Recurrent Layer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../layers/emb/emb.html">
   Embedding Layer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../layers/dropout/dropout.html">
   Dropout Layer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../layers/norm/norm.html">
   Normalization Layer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../layers/padding/padding.html">
   Padding Layer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../layers/pooling/pooling.html">
   Pooling Layer
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../layers/transformer/transformer.html">
   Transformer Block
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/transformer/attn/attn.html">
     Attention
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/transformer/attn/self-attn.html">
     Self Attention
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/transformer/transformer-vs-rnn.html">
     Transformer vs RNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/transformer/training/training.html">
     Training Transformers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/transformer/training/teacher/teacher.html">
     Teacher Forcing vs Scheduled Sampling vs Normal Mode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/transformer/training/token/token.html">
     Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/transformer/training/no-training/no-training.html">
     Using Bert without training?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../layers/activation/activation.html">
   Activation Functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/activation/relu/relu.html">
     Rectified Linear Unit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/activation/sigmoid/sigmoid.html">
     Sigmoid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/activation/softmax/softmax.html">
     Softmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../layers/activation/tanh/tanh.html">
     Hyperbolic Tangent
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Frequently encountered issues
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../issues.html">
   Frequently Encoutered Issues
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Batch size
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../gradient/norm.html">
   Gradient Vanishing / Gradient Explosion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../gradient/saddle.html">
   Saddle point
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lr/lr.html">
   Learning Rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/overfit.html">
   Overfit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/underfit.html">
   Underfit
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Generative Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../generative/generative.html">
   Generative Models
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../generative/ae/ae.html">
   AutoEncoder Model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../generative/ae/ae-arch.html">
     Auto Encoder Architecture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../generative/ae/ae-semi.html">
     Improving Auto Encoders with Semi Supervised Training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../generative/ae/vae/vae.html">
     Variational AutoEncoder Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generative/gan/gan.html">
   Generative Adversarial Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generative/gmm/gmm.html">
   Gaussian Mixture Model
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Improvements to a model
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../better/better.html">
   Improvements to a model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../better/explainable/explainable.html">
   Explainable AI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../better/meta/meta.html">
   Meta Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../better/lll/lll.html">
   Life Long Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../better/compression/compression.html">
   Model Compression
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Using existing models to improve models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../reuse/reuse.html">
   Reusing Existing Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reuse/da/da.html">
   Domain Adaptation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reuse/transfer/transfer.html">
   Transfer Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reuse/distil/distil.html">
   Knowledge Distilation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Beyond supervised training
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../not-supervised/semi-supervised/semi-supervised.html">
   Semi Supervised Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../not-supervised/unsupervised.html">
   Unsupervised Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../not-supervised/decision-tree/decision-tree.html">
   Decision Tree
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../not-supervised/clustering/clustering.html">
   Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../not-supervised/self-supervised/self-supervised.html">
   Self Supervised Learning
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/issues/batch/batch.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/rentruewang/learning-machine"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/rentruewang/learning-machine/issues/new?title=Issue%20on%20page%20%2Fissues/batch/batch.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/rentruewang/learning-machine/edit/main/book/issues/batch/batch.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/rentruewang/learning-machine/main?urlpath=tree/book/issues/batch/batch.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-are-batches">
   What are batches
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#batch-size-too-small">
   Batch size too small
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#training-takes-a-long-time">
     Training takes a long time.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-training-does-not-converge">
     The training does not converge.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#batch-size-too-big">
   Batch size too big
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#training-takes-a-lot-of-time">
     Training takes a lot of time.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#so-how-should-i-choose-batch-sizes">
   So, how should I choose batch sizes?
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="batch-size">
<h1>Batch size<a class="headerlink" href="#batch-size" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-are-batches">
<h2>What are batches<a class="headerlink" href="#what-are-batches" title="Permalink to this headline">¶</a></h2>
<p>Machine learning models are usually trained on batches of data. A batch is simply a number (usually the power of 2), that a model trains itself on in an iteration. For example, batch size 32 means that the model takes in these 32 entries of data, averaging its output, and trains on the 32 labels of the entires.</p>
</div>
<div class="section" id="batch-size-too-small">
<h2>Batch size too small<a class="headerlink" href="#batch-size-too-small" title="Permalink to this headline">¶</a></h2>
<p>When batch sizes are too small, there are several issues that we may encounter.</p>
<div class="section" id="training-takes-a-long-time">
<h3>Training takes a long time.<a class="headerlink" href="#training-takes-a-long-time" title="Permalink to this headline">¶</a></h3>
<p>When training on GPUs, data is sent to the GPU batch by batch, with the overhead of transfering data back and forth. If the batch size is too small, we spend a much higher percentage of time sending data than actually computing. This is the reason we usually prefer bigger batches.</p>
</div>
<div class="section" id="the-training-does-not-converge">
<h3>The training does not converge.<a class="headerlink" href="#the-training-does-not-converge" title="Permalink to this headline">¶</a></h3>
<p>In probability theory, variance measures how much the input varies, how close on average are two inputs. Let’s plot two distributions with different variances.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">variance</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/batch_6_0.png" src="../../_images/batch_6_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">variance</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/batch_7_0.png" src="../../_images/batch_7_0.png" />
</div>
</div>
<p>See how the first distribution is narrower than the second distribution. That means, the number sampled (numbers yielded from) the distribution is closer to one another, and changes little. A smaller variance helps the machine learning model to learn faster, because it’s easier to learn from a simpler input than from inputs that can change a lot. For that reason, averages are easier to learn than individuals.</p>
</div>
</div>
<div class="section" id="batch-size-too-big">
<h2>Batch size too big<a class="headerlink" href="#batch-size-too-big" title="Permalink to this headline">¶</a></h2>
<div class="section" id="training-takes-a-lot-of-time">
<h3>Training takes a lot of time.<a class="headerlink" href="#training-takes-a-lot-of-time" title="Permalink to this headline">¶</a></h3>
<p>When batch size is too big, trainig can also take a long time, but for different reasons. It’s again related to variance.</p>
<p>There are certain problems in machine learning that gradients can be small, close to 0. In such a case, when the batch is overly big, the gradients can average so close to zero that it hinders progress of convergence. Well, worry not! Most of us aren’t rich enough to use those kind of batch sizes (because of expensive GPUs).</p>
</div>
</div>
<div class="section" id="so-how-should-i-choose-batch-sizes">
<h2>So, how should I choose batch sizes?<a class="headerlink" href="#so-how-should-i-choose-batch-sizes" title="Permalink to this headline">¶</a></h2>
<p>Batch sizes are very tricky. Both too big and too small can make training very slow. So make sure to try different batch sizes and observe before commiting to training the whole dataset.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./issues/batch"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../issues.html" title="previous page">Frequently Encoutered Issues</a>
    <a class='right-next' id="next-link" href="../gradient/norm.html" title="next page">Gradient Vanishing / Gradient Explosion</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By RenChu Wang<br/>
        
            &copy; Copyright RenChu Wang, 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>