<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Objectives - Learning Machine</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="To do machine learning, one must learn machine.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../intro.html">Introduction</a></li><li class="chapter-item expanded "><a href="../getting-started/overview.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting-started/funcs.html"><strong aria-hidden="true">1.1.</strong> Models</a></li><li class="chapter-item expanded "><a href="../getting-started/obj.html" class="active"><strong aria-hidden="true">1.2.</strong> Objectives</a></li><li class="chapter-item expanded "><a href="../getting-started/optim.html"><strong aria-hidden="true">1.3.</strong> Optimization</a></li><li class="chapter-item expanded "><a href="../getting-started/linear-case.html"><strong aria-hidden="true">1.4.</strong> Case Study: Linear Models</a></li><li class="chapter-item expanded "><a href="../getting-started/ccc.html"><strong aria-hidden="true">1.5.</strong> CCC</a></li></ol></li><li class="chapter-item expanded "><a href="../what-we-want/overview.html"><strong aria-hidden="true">2.</strong> What we want</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../what-we-want/correctness.html"><strong aria-hidden="true">2.1.</strong> Correctness</a></li><li class="chapter-item expanded "><a href="../what-we-want/simplicity.html"><strong aria-hidden="true">2.2.</strong> Simplicity</a></li><li class="chapter-item expanded "><a href="../what-we-want/ccc.html"><strong aria-hidden="true">2.3.</strong> CCC</a></li></ol></li><li class="chapter-item expanded "><a href="../digging-deeper/overview.html"><strong aria-hidden="true">3.</strong> Digging Deeper</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../digging-deeper/no-myths.html"><strong aria-hidden="true">3.1.</strong> No More Myths</a></li><li class="chapter-item expanded "><a href="../digging-deeper/approx.html"><strong aria-hidden="true">3.2.</strong> Approximation</a></li><li class="chapter-item expanded "><a href="../digging-deeper/ccc.html"><strong aria-hidden="true">3.3.</strong> CCC</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Learning Machine</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/r3ntru3w4n9/learning-machine/tree/master/en" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="what-is-a-better-function"><a class="header" href="#what-is-a-better-function">What is a better function?</a></h1>
<p><em>We need a way to tell us that a function is good.</em></p>
<p>Let's be honest, we are learning machine learning for some serious, important, big brain things. We want the model to be as good as possible at what it does. But what is good? </p>
<pre><code class="language-python">def f(x: float) -&gt; float:
    &quot;The function looks good&quot;
    return 3 * x + 5


def g(x: float) -&gt; float:
    &quot;The function also looks good&quot;
    return 8 * x - 1
</code></pre>
<p>A clever way to say one model is better than another model is to compare those models. <em>Turns out, in math, it's illegal to compare different vectors (an array of numbers), so our options are limited to scalars (single numbers).</em> But what scalar? </p>
<h2 id="loss"><a class="header" href="#loss">Loss</a></h2>
<p>In machine learning, there are a lot of tasks tackling real world problems. Such as understanding images. Such as predicting the next champion team of the world cup. There are too many possibilities in the real world. To deal with that problem, scientists basically give up. They stop trying to create a new prefect model. Instead, they focus on a model that solves problems good enough. They use a scalar to determine how far away the model's prediction of a known problem is different from the right answer, it's very common to call the scalar <strong>loss</strong>.</p>
<p>The smaller the loss, the better the function is. Usually the loss is a positive number, but occasionally we see negative losses permitted in a problem. As long a smaller loss indicates a better function. To calculate loss, we define a <strong>loss function</strong>. <em>The loss function is defined to operate on the function itself (it's a function of function) and output how good the model is. Realistically though, the loss function operates on the output of the function and determines how good that output is.</em> To further clarify what I mean</p>
<h3 id="loosely-defined-loss-function-the-one-used-in-pytorch-tensorflow-etc"><a class="header" href="#loosely-defined-loss-function-the-one-used-in-pytorch-tensorflow-etc">Loosely defined loss function (the one used in PyTorch, TensorFlow, etc):</a></h3>
<pre><code class="language-python">def distance(x: ndarray, y: ndarray) -&gt; float:
    &quot;&quot;&quot;
    This function is for calculating the distance between x and y
    In this case, it's the squared-euclidean distance
    &quot;&quot;&quot;
    return ((x - y) ** 2).sum().item()
</code></pre>
<h3 id="formally-defined-loss-function"><a class="header" href="#formally-defined-loss-function">Formally defined loss function:</a></h3>
<pre><code class="language-python">def loss_func(F: Callable, real_x: ndarray, real_y: ndarray) -&gt; float:
    &quot;&quot;&quot;
    loss_func calls the function for you,
    and evaluate how far in the model's output to the correct output.
    &quot;&quot;&quot;

    pred_y = F(real_x)
    loss = distance(pred_y, real_y)

    # Optimize the function based on loss
    optimize_function(F)

    return loss
</code></pre>
<p>We will talk about how to optimize the function in the next chapter.</p>
<p>In practice you often see the loosely defined loss function instead of the formally defined loss function. After all it's more flexible, and is better suited to be provided as a library function. However, since models and losses are discussed all together in the optimization phase, we will use the formally defined loss function in this book.</p>
<h2 id="several-commonly-used-loss-functions"><a class="header" href="#several-commonly-used-loss-functions">Several commonly used loss functions:</a></h2>
<h3 id="mean-absolute-error"><a class="header" href="#mean-absolute-error">Mean absolute error:</a></h3>
<p>Used in classification as well as regression problems.</p>
<p>Formula:</p>
<p>\[L(x, y) = \sum_{i=1}^n |x_i - y_i|\]
\[x, y \in R^n \]</p>
<p>Code:</p>
<pre><code class="language-python">def mae_loss(x: ndarray, y: ndarray) -&gt; float:
    &quot;MAE: mean absolute error. Mean of absolute difference.&quot;
    return np.abs(x - y).mean().item()
</code></pre>
<h3 id="mean-squared-error"><a class="header" href="#mean-squared-error">Mean squared error:</a></h3>
<p>Used in classification as well as regression problems.</p>
<p>Formula:</p>
<p>\[L(x, y) = \sum_{i=1}^n (x_i - y_i)^2\]
\[x, y \in R^n \]</p>
<p>Code:</p>
<pre><code class="language-python">def mse_loss(x: ndarray, y: ndarray) -&gt; float:
    &quot;MSE: mean absolute error. Mean of squared difference.&quot;
    return np.power(x - y, 2).mean().item()
</code></pre>
<h4 id="cross-entropy-loss"><a class="header" href="#cross-entropy-loss">Cross-entropy loss:</a></h4>
<p>Used in classification problems only.</p>
<p>Formula:</p>
<p>\[L(x, y) = - \sum_{i=1}^n x_i \log_2 y_i\]
\[x_i, y_i \in [0, 1] \]</p>
<p>Code:</p>
<pre><code class="language-python">def ce_loss(x: ndarray, y: ndarray) -&gt; float:
    &quot;CE: Cross entropy. You will learn about this later.&quot;
    return -(x * np.log2(y)).sum().item()
</code></pre>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>To define a good function, we have to <strong>find the loss that for this function</strong>. . To find the loss of a function, we <strong>use a loss function to find out the loss</strong>. <strong>A good loss function shows far how the output of the model is from a good output</strong>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../getting-started/funcs.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../getting-started/optim.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../getting-started/funcs.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../getting-started/optim.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        <script type="text/javascript">
            window.playground_line_numbers = true;
        </script>
        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        
        <script src="../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>
        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
